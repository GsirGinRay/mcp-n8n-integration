# 語音自動加入Google日曆工作流設置指南

## 📋 功能概述
這個工作流可以接收語音輸入，自動轉換為文字，解析日期時間信息，並在Google日曆中創建相應的事件。

## 🔧 設置步驟

### 1. API 憑證配置

#### Google Speech-to-Text API
1. 前往 [Google Cloud Console](https://console.cloud.google.com/)
2. 啟用 Speech-to-Text API
3. 創建服務帳戶金鑰
4. 在 n8n 中添加 "Google Speech API" 憑證

#### Google Calendar API  
1. 在 Google Cloud Console 中啟用 Calendar API
2. 設置 OAuth 2.0 憑證
3. 在 n8n 中添加 "Google Calendar OAuth2 API" 憑證

### 2. 工作流導入
1. 複製 `voice-to-calendar-workflow.json` 內容
2. 在 n8n 中選擇 "Import from JSON"
3. 貼上工作流 JSON 配置

### 3. 節點配置檢查
- **Webhook節點**: 確認路徑為 `/voice-calendar`
- **語音轉文字節點**: 選擇正確的憑證和語言設置
- **Google Calendar節點**: 配置正確的憑證

## 📱 使用方式

### 語音輸入格式範例
- "明天下午3點開會討論專案進度"
- "下週一上午9點面試新員工"
- "今天晚上7點和朋友聚餐"
- "2024年3月15日下午2點醫生預約"

### API 調用方式
```bash
curl -X POST https://your-n8n-instance.com/webhook/voice-calendar \
  -H "Content-Type: application/json" \
  -d '{
    "audioFile": "base64編碼的音檔或音檔URL"
  }'
```

### 回應格式
**成功回應:**
```json
{
  "success": true,
  "message": "日曆事件已成功創建",
  "eventId": "calendar_event_id",
  "summary": "會議 - 明天下午3點開會討論專案進度",
  "startTime": "2024-01-16T15:00"
}
```

**錯誤回應:**
```json
{
  "success": false,
  "message": "創建日曆事件時發生錯誤",
  "error": "具體錯誤信息"
}
```

## 🎯 支持的語音指令模式

### 日期識別
- 相對日期: 今天、明天、後天、下週
- 絕對日期: 3月15日、2024年3月15日

### 時間識別  
- 12小時制: 上午9點、下午3點、晚上7點
- 24小時制: 9點、15點、19點
- 分鐘: 9點30分、15點45分

### 事件類型
- 會議、開會、約會
- 聚餐、運動、健身
- 上課、工作、面試

## ⚙️ 自定義設置

### 修改語言設置
在語音轉文字節點中修改 `language` 參數:
- 繁體中文: `zh-TW` 
- 簡體中文: `zh-CN`
- 英文: `en-US`

### 調整事件持續時間
在創建日曆事件節點的 `end` 參數中修改:
- 目前設置為1小時 (3600000毫秒)
- 可根據需求調整為30分鐘、2小時等

### 擴展自然語言處理
在文字解析節點中添加更多模式匹配:
```javascript
const patterns = {
  // 添加更多日期格式
  date: /(今天|明天|後天|下週|([0-9]{1,2}月[0-9]{1,2}日))/g,
  // 添加更多時間格式  
  time: /(上午|下午|早上|晚上)?([0-9]{1,2})[:點]?([0-9]{1,2}分?)?/g,
  // 添加更多事件類型
  event: /(會議|開會|約會|聚餐|運動|健身|上課|工作|面試|購物|旅行)/g
};
```

## 🔍 故障排除

### 常見問題
1. **語音識別失敗**: 檢查音檔格式和 API 憑證
2. **日期解析錯誤**: 確認語音內容包含明確的日期時間信息  
3. **日曆創建失敗**: 驗證 Google Calendar API 權限和憑證

### 調試技巧
- 在每個節點後添加 "Edit Fields" 節點來查看數據流
- 使用 n8n 的執行日誌來追蹤錯誤
- 測試時使用簡單明確的語音指令

## 📈 進階功能建議

1. **智能重複事件**: 識別"每週"、"每月"等重複模式
2. **多人會議**: 解析參與者信息並發送邀請
3. **地點識別**: 提取地點信息並添加到日曆事件
4. **提醒設置**: 根據事件類型自動設置提醒時間
5. **衝突檢測**: 檢查時間衝突並提供建議

## 🔐 安全注意事項

- 定期輪換 API 金鑰
- 限制 Webhook 訪問權限
- 不在日誌中存儲敏感語音內容
- 實施適當的訪問控制和審計機制